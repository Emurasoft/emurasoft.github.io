# Version 25.4

2025年 11月 5日

## 一般の新機能

- EmEditor 本体でスニペットを定義できるようになりましました。従来からある[スニペット プラグイン](../howto/plugin/plugin_snippets)を使用して、スニペットを挿入できるようになります。スニペットは、メニューからアクセスできるだけでなく、ツール バーのボタン、キーボード ショートカットを定義できるようになりました。Markdown/HTML ツール バーの好きな位置に定義したスニペット ボタンを置くことも可能です。{{pro}}
- スニペット ツール バーを追加しました。{{pro}}
- [検索]、[置換]、[ファイルから検索]、[ファイルから置換] を含む様々な動作を高速化しました。{{profree}}

### テスト結果:

|  | v25.3 | v25.4 | v25.3 と比較 |
| --- | --- | --- | --- |
| ファイルから検索 \[\*A\] | 2.566 秒 | 0.393 秒 | 6.53 倍に高速化 |
| ファイルから置換 \[\*B\] | 2.062 秒 | 1.034 秒 | 1.99 倍に高速化 |
| 検索 (すべて選択) \[\*C\] | 0.189 秒 | 0.051 秒 | 3.71 倍に高速化 |
| すべて置換 \[\*D\] | 0.188 秒 | 0.063 秒 | 2.98 倍に高速化 |

\*A: 14個の ASCII または UTF-8 ランダム ファイル、計 3.81 GB から "abc" を検索。
\*B: 14個の ASCII または UTF-8 ランダム ファイル、計 3.81 GB から "abc" を "###" に置換。
\*C: "αβ" をすべて選択、2.00 GB Wikipedia ダンプ ファイル (UTF-8)。
\*D: "αβ" を "##" にすべて置換、2.00 GB Wikipedia ダンプ ファイル (UTF-8)。
\*すべて: すべて既定オプション、Windows 11、Ryzen 9 7950X、96 GB RAM。

## 新しい設定

- [カスタマイズ] ダイアログ ボックスに [[スニペット] ページ](../dlg/customize/snippets/index)を追加しました。 {{pro}}
- [マーカーのカスタマイズ] のすべてのページを [カスタマイズ] ダイアログ ボックスの [[マーカー] ページ](../dlg/customize/markers/index)に移動しました。{{profree}}
- [\[ツール バー ボタンのプロパティ\] ダイアログ ボックス](../dlg/customize/toolbar_buttons/properties/index)に [カスタム アイコン] チェック ボックスを追加しました。{{pro}}
- [\[ファイルから検索\] ダイアログ ボックス](../dlg/find_in_files/index)の \[出力オプション\] ドロップダウン リスト ボックスに [ファイル名、行、一致した行を表示 (長い行を切り詰め)] 項目を追加しました。{{profree}}
- [カスタマイズ] ダイアログ ボックスの [[ショートカット] ページ](../dlg/customize/shortcut/index)から [Internet Explorer でソース表示] チェック ボックスを削除しました。{{pro}}

## 新しいコマンド

- [スニペットの挿入](../cmd/insert/insert_snippet1) {{pro}}
- [スニペット ツール バー](../cmd/view/show_snippets_bar) {{pro}}
- [スニペットのカスタマイズ](../cmd/tools/customize_snippets) {{pro}}
- [マーカーのカスタマイズ - マーカー一覧]、[マーカーのカスタマイズ - 自動マーカー]、[マーカーのカスタマイズ - オプション] コマンドを削除しました。{{profree}}

## プラグインの新機能 {{pro}}

-  [GREP_INFO_EX 構造体](../plugin/structure/grep_info_ex)に、FLAG_FIND_TRUNCATE フラグを追加しました。

### AIとチャット

- チャット メッセージの保存バックエンドを変更し、整理性の向上とパフォーマンス最適化を図りました。
- [設定] - [AI接続] に [...環境変数を使用する] オプションを追加し、AIとチャットが環境変数を API キーとして使用できるようにしました。
- [設定] - [AIパラメータ] に [Web検索] オプションを追加し、GPT-5 など一部の OpenAI モデルが最新情報を取得するためにインターネット検索を行えるようにしました。
- [設定] - [AIパラメータ] に [テキスト冗長] オプションを追加し、テキスト出力の詳細度を制御できるようにしました。

## マクロの新機能 {{pro}}

- Editor オブジェクトの [FindInFiles メソッド](../macro/editor/editor_findinfiles)に、eeFindFileLineTruncated フラグを追加しました。

### 注

- \[P\] EmEditor Professional のみ
- \[PF\] EmEditor Professional と EmEditor Free
