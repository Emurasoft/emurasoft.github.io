# Version 9

2009年10月14日

## 一般の新機能

- CSV (カンマ区切り)、TSV (タブ区切り)、DSV (ユーザー定義区切り) モードが追加されました。指定するカラムだけを箱型選択したり、指定するカラムのテキストまたは数値で並べ替えを行うことができるようになりました。部分編集機能と併用して、指定する行だけを並べ替えることもできます。
- 部分編集機能が追加されました。 [**\[部分編集の設定/解除\]** コマンド](../cmd/edit/narrowing_toggle) は、選択範囲のみを編集可能な領域として設定します。(部分編集を行う前に、「ページ区切り線」の背景色を通常と異なる色にしておくことをおすすめします。)
- Windows 7 ジャンプ リストがサポートされました。ジャンプ リストもカスタマイズできます。ジャンプ リストには、\[最近使ったもの\] カテゴリーも含まれます。\[最近使ったもの\] カテゴリーが動作するためには、 [**\[カスタマイズ\]** ダイアログ ボックス](../dlg/customize/index) の [**\[ファイル\]** ページ](../dlg/customize/file/index) で、 **\[常に最近使ったファイルに追加する\]** チェック ボックスがチェックされていることが必要です。\[最近使ったもの\]
カテゴリーは、EmEditor が管理する \[最近使ったファイル\] メニューと異なり、EmEditor と関連付けられた拡張子を持つファイルのみが \[最近使ったもの\] カテゴリーに追加されます。
- Windows 7 タスク ボタン プログレス バーがサポートされました。
- 全画面表示モードが追加されました。
- クリップボード履歴機能が追加されました。
- トレイ アイコンのメニューを含む最近使ったファイル (またはフォルダ) の一覧で右クリックで表示されるコンテキスト メニューに、\[この一覧に常に表示\]、\[この一覧に常に表示しない\]、\[この一覧から削除\]、\[このフォルダから開く\]、\[Windows エクスプローラを開く\]、\[コマンド プロンプトを開く\]、\[パスのコピーコマンド\] コマンドを追加しました。
- コマンド ラインでワイルドカードがサポートされました。たとえば、「emeditor.exe \*.txt」を実行すると、現在のフォルダ内のすべての txt ファイルを開きます。
- 新しいコマンド ライン オプション (/act、/clw、/cjl、/n、/od、/rr、/scrlf、/scr、/slf) が追加されました。
- かっこ/引用符の自動補完が可能になりました。たとえば、{ と入力すると、} が自動的に補完されます。} が自動的に補完された直後のカーソル位置は、{\|} というように {} の間になります。この状態で、さらに } をタイプしても、} が 2 重になることはありません。
- C++ などで、#include や Label: の後のインデントを無視できるようになりました。
- \[検索\]、\[置換\] ダイアログ ボックスで、インクリメンタル サーチが可能になりました。
- \[検索\]、\[置換\] ダイアログ ボックスで、\[=\] ボタンをクリックして、単一行と複数行を切り替えられるようになりました。
- \[ファイルから検索\]、\[ファイルから置換\] ダイアログ ボックスはモードレスになりました。
- 正規表現の置換表現に、条件表現 (?n:true\_expression:false\_expression ) が追加されました。
- アウトプット バーに標準入力を入力できるようになりました。
- タブのドラッグ & ドロップは、現在のファイルのコピー、ショートカットの作成、グループの新規作成から選択できるようになりました。
- ツール ツール バーのボタンを右クリックして、ツール プロパティを直接表示できるようになりました。
- マクロ パスは、「My Macros」フォルダからの相対パスとして保存できるようになりました。
- **\[次の文字を英数字として扱う\]** テキスト ボックスで指定された文字は、検索/置換の単語のみ検索でも反映されるようになりました。
- カーソル サイズと色がカスタマイズできるようになりました。
- Windows Vista 以降で、ユーザー アカウント制御が有効の場合、C:\\Program Files のように保護されたフォルダ内にも、権限昇格の確認プロンプトの後、ファイルを保存できるようになりました。
- ワークスペースについて「保存、復元と元に戻す情報を保持」と、「保存、復元と元に戻す情報を保持し、ファイルの保存を促さない」のオプションを追加しました。また、EmEditor を終了時に、ワークスペースの保存を行うかどうかを設定することができる、ダイアログ ボックスを表示するようになりました。このダイアログ ボックスは、「今後、表示しない」をチェックすることによって、表示しなくすることもできます。
- 水平罫線、垂直罫線は、テキストの下に描画するようになり、テキスト描画のちらつきは完全に無くなりました。
- エンコードの自動検出ダイアログ ボックスに、UTF-16 が追加されました。
- ルーラーの右クリックでメニューが表示されるようになり、\[CSV モードの切り替え\]、\[カンマ位置を調節\]、\[CSV列を選択\] コマンドを追加しました。
- 外部ツールに、標準入力、標準出力に関する機能を追加しました。これにより、外部ツールをフィルタとして使用することができるようになりました。
- 外部ツールにカーソル行テキストやテキスト全体を変数として渡せるようになりました。
- 外部ツールの出力結果を編集中のテキストに取り込めるようになりました。
- 外部ツールの設定の出力エンコードに「アクティブな文書のエンコードに合わせる」を追加しました。
- IME の前後参照変換に対応。
- 選択されていない状態でも \[再変換\] キーを押して再変換できるようになりました。
- メイン ツール バーのプラグイン ボタンも右クリックしてプロパティ変更できるようになりました。
- カスタム バーの文字色/背景色を指定できるようになりました。
- 箱形選択でコピーしたクリップボードのフォーマットを Visual Studio と互換にしました。
- ファイルをオープンした時にヌル文字や不正な文字が存在して、警告メッセージを表示した後、現在のエンコード継続すると、カーソルが不正な文字位置にジャンプするようになりました。
- ツール バーに 16 個の新しいボタンを追加しました。
- ツール バーの ![](../images/fileopen.gif)
(\[開く\] ボタン) の右に下矢印を追加し、そこをクリックすることによって最近開いたファイル/フォルダの一覧を表示できるようになりました。
- ツール バーの ![](../images/paste.gif)
(\[貼り付け\] ボタン) の右に下矢印を追加し、そこをクリックすることによってクリップボードの過去のテキストを貼り付けることができるようになりました。

## プラグイン新機能

### スニペット プラグイン

- スニペット ツリーには、スニペットだけでなくマクロも含めることができるようになりました。スニペットの場合もマクロの場合も、マクロ ファイルに保存する必要はありません。
- それぞれの項目のトリガー文字列とショートカット キー (既定は Tab) を定義できるようになりました。
- ヒント文字列を指定できるようになり、トリガー文字列が一致するとヒントが表示されるようになりました。ヒントの詳細や遅延時間が設定できるようになりました。
- Tab または Shift+Tab でプレースホルダー間の移動ができるようになりました。
- スニペットやマクロのテキストは EmEditor のエディタで編集できるようになりました。
- スニペット カスタムバーが表示されていなくてもバックグラウンドで実行できるようになりました (プラグインのプロパティで設定可能)。
- グローバル パラメータを設定できるようになりました。
- 新しい Interface オブジェクトを使用して、スニペットとマクロの間のやり取りができるようになりました。
- パラメータ シンボルは \\{x} から ${x} に変更されました。
- インポート コマンドを使用するか、エクスプローラからスニペット ツリーにスニペット ファイルをドラッグ & ドロップすることにより、EmEditor または TextMate 用のスニペットを簡単にインポートできるようになりました。
- 新しいシェル コード フォーマットによりスニペットをフィルターとして使用できるようになりました。シェル コードにより、テキストを外部ツールの標準入力に渡して、標準出力を受け取ってスニペットとして挿入できるようになりました。

### アウトライン プラグイン

- \[部分編集\] コマンド、\[部分編集の解除\] コマンドを追加しました。
- コメントも縮小できるようになりました (アウトライン プラグインのプロパティの \[コメントを縮小可能にする\] チェック ボックス)。

### プロジェクト プラグイン

- プロジェクトにファイルを追加するときに (ドラッグ＆ドロップを含む) ワイルドカードを使って、含めるファイルと除外するファイル/フォルダを指定できるようになりました。(\[ソリューション プロパティ\] \- \[一般\] ページ \- \[含めるファイル\]、\[除外するファイル\]、\[除外するフォルダ\] テキスト ボックス) 。
- 固定のタグ ファイルを使用できるようになりました。タグ ファイル名は、ソリューション テンプレートのプロパティのシンボル ページで指定できます。

### エクスプローラ プラグイン

- アイコンのオーバーレイを表示できるようになりました。

## 新しい設定

- **\[インクリメンタル サーチ\]** チェック ボックスと \[＝\] ボタンを [**\[検索\]** ダイアログ ボックス](../dlg/find/index) と [**\[置換\]** ダイアログ ボックス](../dlg/replace/index) に追加しました。
- **\[かっこ/引用符の自動補完\]** チェック ボックスと **\[対応するかっこ\]** リスト ボックスを [設定のプロパティ](../dlg/properties/index) の
[\[強調(2)\] ページ](../dlg/properties/highlight2/index) に追加しました。
- **\[URL をクリックするとそのURLを表示\]** チェック ボックスを [設定のプロパティ](../dlg/properties/index) の [\[リンク\] ページ](../dlg/properties/link/index) に追加しました。
- **\[正規表現を使用する\]** チェック ボックスと **\[次の行の後は無視 (正規表現)\]** テキスト ボックスを [\[タブ/インデント\] ダイアログ ボックス](../dlg/properties/general/indent/index) に追加しました。
- **\[CSV (カンマ区切り) を検出\]** チェック ボックスと **\[TSV (タブ区切り) を検出\]** チェック ボックス、 **\[DSV (ユーザー定義区切り) を検出\]** チェック ボックス、 **\[区切り\]**
テキスト ボックスを [設定のプロパティ](../dlg/properties/index) の
[\[ファイル\] ページ](../dlg/properties/file/index) に追加しました。
- \[検索/置換ダイアログ ボックスで、選択テキストを使用する\] チェック ボックスを [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) の [\[検索\] ページ](../dlg/customize/search/index) に追加しました。
- \[マウスの設定\] ダイアログ ボックスを [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) の [\[マウス\] ページ](../dlg/customize/mouse/index) に移動しました。
- **\[CTRL + ホイールでフォント サイズ変更\]** チェック ボックスを [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) の [\[マウス\] ページ](../dlg/customize/mouse/index) に追加しました。
- カスタム バー色 \- \[システムの色を使用\] チェック ボックス、カスタム バー色 \- \[文字\] ボタン、カスタム バー色 \- \[背景\] ボタン、カーソルのサイズと色 \- \[幅\] ドロップダウン リスト ボックス、カーソルのサイズと色 \- \[高さ\] ドロップダウン リスト ボックス、カーソルのサイズと色 \- \[システムの色を使用\] チェック ボックス、カーソルのサイズと色 \- \[色\] ボタンを [**\[カスタマイズ\]** ダイアログ ボックス](../dlg/customize/index) の [**\[表示\]** ページ](../dlg/customize/view/index) に追加しました。
- [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) に [\[並べ替え\] ページ](../dlg/customize/sort/index) を追加しました。
- **\[自動ワークスペース\]** ドロップダウン リスト ボックスと **\[終了前に確認しない\]** チェック ボックスを [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) の [\[ウィンドウ\] ページ](../dlg/customize/window/index) に追加しました。
- [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) の [\[タブ\] ページ](../dlg/customize/tab/index) にある
**\[外部から開く時\]** ドロップダウン リスト ボックスに \[新規ファイルは新しいウィンドウ、その他は新しいタブ\] オプションを追加しました。
- **\[終了時に閉じる\]** チェック ボックス、 **\[入力\]** ドロップダウン リスト ボックス、 **\[カスタム\]** テキスト ボックス、 **\[EOF を追加\]** チェック ボックス、

**\[出力\]** ドロップダウン リスト ボックス、 **\[標準エラーを含める\]** チェックボックスを [\[外部ツール\] ダイアログ ボックス](../dlg/tools/index) に追加しました。
- **\[EmEditor と関連付け\]** ボタンを [\[カスタマイズ\] ダイアログ ボックス](../dlg/customize/index) の [\[関連付け\] ページ](../dlg/properties/associate/index) に追加しました。

## 新コマンド

- [\[アウトプットのクリア\] コマンド](../cmd/view/output_clear)
- [\[全画面表示\] コマンド](../cmd/view/full_screen)
- [\[クリップボード リングの回転\] コマンド](../cmd/edit/paste_history)
- [\[ジャンプ リストのカスタマイズ\] コマンド](../cmd/tools/customize_jump_list)
- [\[通常モード\] コマンド](../cmd/edit/mode_normal)
- [\[CSVモード\] コマンド](../cmd/edit/mode_csv)
- [\[TSVモード\] コマンド](../cmd/edit/mode_tsv)
- [\[DSVモード\] コマンド](../cmd/edit/mode_dsv)
- [\[区切り位置を調節\] コマンド](../cmd/edit/adjust_column)
- [\[列を選択\] コマンド](../cmd/edit/select_column)
- [\[AからZへ並べ替え\] コマンド](../cmd/edit/sort_text_a)
- [\[ZからAへ並べ替え\] コマンド](../cmd/edit/sort_text_d)
- [\[小さい値から大きい値へ並べ替え\] コマンド](../cmd/edit/sort_num_a)
- [\[大きい値から小さい値へ並べ替え\] コマンド](../cmd/edit/sort_num_d)
- [\[部分編集の設定/解除\] コマンド](../cmd/edit/narrowing_toggle)
- [\[部分編集の設定\] コマンド](../cmd/edit/narrowing_on)
- [\[部分編集の解除\] コマンド](../cmd/edit/narrowing_off)
- [\[固定箱型選択モード\] コマンド](../cmd/edit/vertical_mode)
- [\[左へスクロール\]コマンド](../cmd/window/scroll_left)
- [\[右へスクロール\] コマンド](../cmd/window/scroll_right)
- [\[並べ替えのカスタマイズ\] コマンド](../cmd/tools/customize_sort)
- [\[表示のカスタマイズ\] コマンド](../cmd/tools/customize_view)
- [\[マウスのカスタマイズ\] コマンド](../cmd/tools/customize_mouse)
- [\[更新のチェック\] コマンド](../cmd/help/check_updates)
- [\[更新チェッカーのカスタマイズ\] コマンド](../cmd/help/customize_update_checker)

## マクロ新機能

- [Interface オブジェクト](../macro/interface/index)
- [Interface プロパティ](../macro/window/interface) を [Window オブジェクト](../macro/window/index) に追加しました。
- [IgnoreAfter プロパティ](../macro/indent_prop/ignore_after) と [RegExp プロパティ](../macro/indent_prop/reg_exp) を [IndentProp オブジェクト](../macro/indent_prop/index) に追加しました。
- [DetectCSV プロパティ](../macro/file_prop/detect_csv)、 [DetectTSV プロパティ](../macro/file_prop/detect_tsv)、 [DetectDSV プロパティ](../macro/file_prop/detect_dsv)、Delimiter プロパティを [FileProp オブジェクト](../macro/file_prop/index) に追加しました。
- [clipboardData オブジェクト](../macro/clipboarddata/index) の機能を強化しました。

## 新しいプラグイン API

- [EE\_CLIP\_HISTORY](../plugin/message/ee_clip_history) メッセージ
- [EE\_EDIT\_TEMP](../plugin/message/ee_edit_temp) メッセージ
- [EE\_GET\_ATTR](../plugin/message/ee_get_attr) メッセージ
- [EE\_GET\_OUTPUT\_STRING](../plugin/message/ee_get_output_string) メッセージ
- [EE\_RUN\_MACRO](../plugin/message/ee_run_macro) メッセージ
- [ATTR\_INFO](../plugin/structure/attr_info) 構造体
- [CLIP\_INFO](../plugin/structure/clip_info) 構造体
- [RUN\_MACRO\_INFO](../plugin/structure/run_macro_info) 構造体
- [TEMP\_INFO](../plugin/structure/temp_info) 構造体
- [Editor\_ActivateTemp](../plugin/macro/editor_activatetemp) インライン関数
- [Editor\_CloseTemp](../plugin/macro/editor_closetemp) インライン関数
- [Editor\_EditTemp](../plugin/macro/editor_edittemp) インライン関数
- [Editor\_GetAttr](../plugin/macro/editor_getattr) インライン関数
- [Editor\_GetClip](../plugin/macro/editor_getclip) インライン関数
- [Editor\_GetClipPos](../plugin/macro/editor_getclippos) インライン関数
- [Editor\_GetOutputString](../plugin/macro/editor_getoutputstring) インライン関数
- [Editor\_InsertClip](../plugin/macro/editor_insertclip) インライン関数
- [Editor\_RunMacro](../plugin/macro/editor_runmacro) インライン関数
- [Editor\_SaveTemp](../plugin/macro/editor_savetemp) インライン関数
- [Editor\_RemoveClip](../plugin/macro/editor_removeclip) インライン関数
- [Editor\_RotateClip](../plugin/macro/editor_rotateclip) インライン関数
- [Editor\_SetClipPos](../plugin/macro/editor_setclippos) インライン関数
- [EP\_DISABLE\_AUTO\_COMPLETE](../plugin/plugin_message/ep_disable_auto_complete) プラグインへのメッセージ
- [EVENT\_HISTORY イベント](../plugin/event/index)
- [EVENT\_TEMP\_SAVING イベント](../plugin/event/index)
- EI\_COMBINE\_HISTORY、EI\_GET\_BAR\_TEXT\_COLOR、EI\_GET\_BAR\_BACK\_COLOR、EI\_GET\_RETURN\_TYPE フラグ (EE\_INFO メッセージ)
