# Version 21.1

2021年 8月 31日

## 一般の新機能

- 既定では、新バージョンでは、マイ マクロの1つを選択またはマクロに割り当てられているショートカット キーを押しても、既定のマクロは変更されないようになりました。この動作は、\[マクロのカスタマイズ\] ダイアログ ボックスの \[オプション\] ページの \[マイ マクロの実行で、それを既定のマクロとして設定する\] により変更できます。
- \[マクロ\] メニューのマイ マクロの1つで右クリックして表示されるメニューに \[既定に設定\] コマンドを追加しました。
- 新バージョンでは、既定で \[DirectWrite を使用\] が設定されました (速度が最重要の場合には、このオプションをオフにしてください)。
- 新バージョンでは、カーソルを移動したり、\[文字コード値\] コマンドを選択した際、OS でサポートされている多くの [絵文字シーケンス](https://unicode.org/Public/emoji/14.0/emoji-sequences.txt) と [絵文字 ZWJ シーケンス](https://unicode.org/Public/emoji/14.0/emoji-zwj-sequences.txt) を正しく表示するようになりました。
- 結合文字の Unicode の名前のフォーマットを変更しました (AND の代わりにセミコロンを使用しました)。
- 既定では、インストーラーで、ユーザー毎インストールか、すべてのユーザーへのインストールかを選択するラジオ ボタンを無効にしました。
- 様々な動作を高速化しました。

### テスト 結果:

|  | v21.0 | v21.1 | 比較 |
| --- | --- | --- | --- |
| マクロを実行 (繰り返し文書を切り替えて文字を挿入) | 28.8 秒 | 14.0 秒 | 2.06 倍に高速化 |

\*以下のテスト マクロを使用。Direct Write オフを除いてすべて既定オプション、16 スレッド、Windows 10 (64-bit)、Core i9-9900K、64GB RAM、2TB SSD。

### テスト マクロ:

document.selection.Text="a";

editor.NewFile();

doc1 = editor.Documents.Item(1);

doc2 = editor.Documents.Item(2);

for( i = 0; i < 1000; ++i ) {

doc1.Activate();

doc1.selection.Text="a";

doc2.Activate();

doc2.selection.Text="a";

}

## 新しい設定

- [\[マクロ一時オプション\] ダイアログ ボックス](../dlg/macro_temp_options/index) に \[これを既定のマクロに設定する\] と \[再描画を抑制する\] チェック ボックスを追加しました。
- [\[マクロ一時オプション\] ダイアログ ボックス](../dlg/macro_temp_options/index) で、\[...▼\] ボタンをクリックした時に表示されるメニューに \[(クリップボード)\] オプションを追加しました。
- [\[高度に開く\] ダイアログ ボックス](../dlg/advanced_open/index) に \[これを既定のマクロに設定する\] チェック ボックスを追加しました。
- [\[マクロのカスタマイズ\] ダイアログ ボックス](../dlg/macro_customize/index) の [\[オプション\] ページ](../dlg/macro_customize/options/index) に \[マイ マクロの実行で、それを既定のマクロとして設定する\] チェック ボックスと \[既定の言語\] オプションを追加しました。

## 新しいコマンド

- [クリップボードのマクロを実行](../cmd/macros/macro_run_clipboard)

## プラグインの新機能

- \[単語補完\] プラグインで、辞書が非常に大きい場合に、候補リストを開く速度を高速化しました。

## マクロの新機能

- Editor オブジェクトの [WriteProfileString](../macro/editor/writeprofilestring) メソッドに nType パラメータを追加しました。
