# \[プロジェクト\] プラグインの使い方

EmEditor Professional では、既定でプロジェクト (Projects) プラグインがインストールされます。このプラグインはプロジェクト ツリーを表示し、ファイルを選択して開くことができます。プロジェクト プラグインを使用するには、次の手順に従います。

1. プラグイン バーの **![](../../images/projects.png)** をクリックするか、または \[ツール\] メニューの \[プラグイン\] をポイントし、\[プロジェクト\] を選択します。すると、\[プロジェクト\] カスタム バーが表示されます。
2. \[プロジェクト\] カスタム バーで右クリックを行い、\[プロジェクトの新規作成\] を選択します。
3. 無題プロジェクトで右クリックを行い、\[既存のファイルを追加\] を選択します。
4. プロジェクトに含めたいファイルをすべて選択します。

## 

### プロジェクト プラグインのコマンド

プロジェクト カスタム バーで右クリックを行うと、次の項目を含むメニューが表示されます。

|     |     |
| --- | --- |
| 展開/折りたたみ | ノードを展開または折りたたみます。 |
| すべて開く | フォルダ内のすべてのファイルを開きます。 |
| 開く | ファイルを開きます。 |
| 読み取り専用ファイルとして開く | ファイルを読み取り専用として開きます。 |
| エンコードを指定して開く | ファイルをエンコードを指定して開く |
| フォルダの新規作成 | フォルダを新規作成します。 |
| 切り取り | 選択されている項目を切り取ってクリップボードに保存します。 |
| コピー | 選択されている項目をコピーしてクリップボードに保存します。 |
| 貼り付け | クリップボードの内容を貼り付けます。 |
| 削除 | 選択されている項目を削除します。 |
| 名前の変更 | 選択されている項目の名前を変更します。 |
| ソリューションを実行 | ソリューションを実行します。 |
| ソリューションの新規作成 | ソリューションを新規作成します。 |
| ソリューションを開く | 既存のソリューション ファイルを開きます。 |
| ソリューションを名前を付けて保存 | ソリューション ファイルに名前を付けて保存します。 |
| 最近のソリューションの一覧 | 指定した最近使ったソリューション ファイルを開きます (複数項目)。 |
| プロジェクトの新規作成 | プロジェクトを新規作成します。 |
| プロジェクトを開く | 既存のプロジェクト ファイルを開きます。 |
| プロジェクトを名前を付けて保存 | プロジェクト ファイルに名前を付けて保存します。 |
| 既存のファイルを追加 | 既存のファイルをプロジェクトに追加します。 |
| アクティブなファイルを追加 | 現在アクティブになっているファイルをプロジェクトに追加します。 |
| すべての開いているファイルを追加 | すべての開いているファイルをプロジェクトに追加します。 |
| 最近のプロジェクトの一覧 | 指定した最近使ったプロジェクト ファイルを開きます (複数項目)。 |
| スタートアップ プロジェクトに設定 | 指定したプロジェクトをスタートアップ プロジェクトに設定します。 |
| ファイル名のみ | ファイル名のみを表示します。 |
| 相対パス | 相対パスを表示します。 |
| 完全パス | 完全パスを表示します。 |
| シンボル一覧を最新の情報に更新 | 現在のプロジェクトに対するシンボル一覧を最新の情報に更新します。 |
| すべてのシンボル一覧を最新の情報に更新 | すべてのシンボル一覧を最新の情報に更新します。 |
| シンボル一覧 | シンボル一覧の表示/非表示を切り替えます。 |
| 設定 | 利用可能な設定の一覧を表示します。 |
| プラットフォーム | 利用可のなプラットフォームの一覧を表示します。 |
| 現在のソリューション テンプレートのプロパティ | 現在のソリューション テンプレートのプロパティを表示します。 |
| ソリューション テンプレート | ソリューション テンプレートを定義します。 |
| プラグインのプロパティ | プラグインのプロパティを表示します。 |
| ツールの一覧 | 指定したツールを実行します。 |

### ツール バー

|     |     |
| --- | --- |
| **![](../../images/newsolution.png)** ソリューションの新規作成 | ソリューションを新規作成します。 |
| **![](../../images/opensolution.png)** ソリューションを開く | 既に存在するソリューション ファイルを開きます。 |
| **![](../../images/runsolution.png)** ソリューションを実行 | オープンされたソリューションを実行します。 |
| **![](../../images/parameterinformation.png)** パラメータ情報 | パラメータ情報を表示します。 |
| **![](../../images/gotodefinition.png)** 定義へ移動 | 定義位置にジャンプします。 |
| **![](../../images/popbrowsecontent.png)** ブラウズ コンテキストのポップ | カーソルを元の位置に戻します。 |
| **![](../../images/symbollist.png)** シンボル一覧 | シンボルの一覧を表示します。 |
| **![](../../images/propertiesforcurrentsolutiontemplate.png)** 現在のソリューション テンプレートのプロパティ | 現在のソリューション テンプレートのプロパティを表示します。 |
| **![](../../images/solutiontemplates.png)** ソリューション テンプレート | ソリューション テンプレートの設定ダイアログ ボックスを表示します。 |
| **![](../../images/pluginproperties.png)** プラグインのプロパティ | プラグインのプロパティを表示します。 |

### ソリューション テンプレート

プロジェクト プラグインで作成する、開く、または保存するすべてのソリューションは、どれからのソリューション テンプレートに属します。ソリューション テンプレートでは、ファイル拡張子のほか、フォーマット、マクロ、ツール、キーボード ショートカットなどの設定を指定することができます。ソリューション ファイルを開くと、ファイル拡張子に関連付けられたソリューション テンプレートが選択され、テンプレートで定義されたように動作します。

### \[ソリューション テンプレート\] ダイアログ ボックス

このダイアログ ボックスは、![](../../images/solutiontemplates.png) ボタンをクリックすると表示されます。一覧には、利用可能なソリューション テンプレートが表示されます。\[プロパティ\] ボタンをクリックすると、選択されたソリューション テンプレートのプロパティを表示します。

### ソリューション テンプレートのプロパティ

\[一般\] ページ

|     |     |
| --- | --- |
| ソリューション フォーマット | ソリューションのフォーマットを選択します。現在、EmEditor と Visual Studio のみが選択可能です。 |
| ファイル拡張子 | ソリューションのファイル拡張子を指定します。ソリューションを開く時、ここで指定するファイル拡張子に関連付けられたソリューション テンプレートが自動的に選択されます。 |
| 書き換え禁止 | 書き換え禁止かどうかを指定します。書き換え禁止を指定すると、プロジェクトにファイルを追加することができなくなり、ソリューションを保存の際、プロジェクト ファイルを上書きすることはありません。 |
| 含めるファイル | プロジェクト ツリーにファイルをドラッグ&ドロップする際に含めるファイルの種類を指定します。たとえば、.c と .cpp の両方のファイルを含めたい場合には「\*.c;\*.cpp」と指定します。 |
| 除外するファイル | プロジェクト ツリーにファイルをドラッグ&ドロップする際に除外するファイルの種類を指定します。たとえば、.com と .exe の両方のファイルを除外したい場合には「\*.com;\*.exe」と指定します。 |
| 除外するフォルダ | プロジェクト ツリーにフォルダをドラッグ&ドロップする際に除外するフォルダを指定します。たとえば、folder1 と folder2 の両方のフォルダを除外したい場合には「folder1;folder2」と指定します。 |

\[設定\] ページ

|     |     |
| --- | --- |
| 設定 | 定義されている設定を選択します。\[新規作成\] を選択すると、新しい設定を定義することができます。\[編集\] を選択すると、設定を削除することができます。 |
| プラットフォーム | 定義されているプラットフォームを選択します。\[新規作成\] を選択すると、新しいプラットフォームを定義することができます。\[編集\] を選択すると、プラットフォームを削除することができます。 |
| マクロ | 定義されているマクロの一覧が表示されます。選択されている設定とプラットフォームに対するマクロの値を指定することができます。 |
| 新規作成 | このボタンをクリックすると、新しいマクロを作成します。 |
| 削除 | このボタンをクリックすると、選択されているマクロを削除します。 |
| 名前の変更 | このボタンをクリックすると、選択されているマクロの名前を変更します。 |

\[シンボル\] ページ

|     |     |
| --- | --- |
| すべてのシンボル一覧を自動更新する | ファイルが追加されたときなどに、すべてのシンボル一覧を自動的に更新するかどうかを指定します。 |
| Ctags への追加パラメータ (高度な設定) | Ctags への追加パラメータを指定します。これは高度な設定であり、間違ったパラメータを指定すると、正しく動作しなくなる可能性があります。 |

\[ツール\] ページ

|     |     |
| --- | --- |
| ツール | 定義されているツールの一覧が表示されます。 |
| 新規作成 | 新しいツールを作成します。 |
| 削除 | 選択されたツールを削除します。 |
| コピー | 選択されたツールをコピーします。 |
| 上へ移動 | 選択されたツールを上へ移動します。 |
| 下へ移動 | 選択されたツールを下へ移動します。 |
| プロパティ | 選択されたツールのプロパティを表示します。 |

\[キーボード\] ページ

|     |     |
| --- | --- |
| コマンド | ここに利用できるコマンドの一覧が表示されています。 |
| 追加するショートカット キー | ここに追加するショートカット キーを入力してください。 |
| 現在のキー | 選択されているコマンドに対して現在割り当てられているショートカット キーの一覧が表示されています。 |
| 割り当て | 入力したショートカット キーを選択されているコマンドに割り当てます。 |
| 削除 | 選択されているショートカット キーを削除します。 |

### ソリューション用の設定とマクロの作り方

ソリューション テンプレートのプロパティの \[設定\] ページでは、設定を作成してマクロを定義することができます。新しい設定を作成するには、以下の手順に従います。

1. \[設定\] ドロップダウン リストをクリックして、\[<新規作成>\] を選択します。
2. 設定名を指定します。たとえば、Debug という名前の設定を作成します。
3. \[新規作成\] ボタンをクリックすると、各設定に対してマクロを作成することができます。たとえば、OPTIONS というマクロを作成して、その値に /D \_Debug と指定します。
4. ここで、1\. ～ 2. の手順を繰り返して、今度は Release という名前の設定を作成します。
5. Release が選択された状態で、OPTIONS マクロを選択して、その右の値をクリックして、/O1 という値に変更します。
6. 以上で、設定を定義し、各設定に対するマクロを作成しました。

### ソリューション用ツールの作り方

ソリューション テンプレートのプロパティの \[ツール\] ページでは、新しいツールを作成することができます。ツール プロパティでは、タイトル、コマンド、引数、初期ディレクトリ、アイコン パス、現在のアイコンなどを指定することができます。ツール プロパティでは、あらかじめ定義されているマクロ、たとえばファイル パスや現在の行を指定したり、自分で定義したマクロを指定することができます。新しいツールを作成するには、次の手順に従います。

1. ソリューション テンプレートのプロパティの \[ツール\] ページで、\[新規作成\] ボタンをクリックします。
2. ツールのタイトルに、好きな名前、たとえば、「コンパイル」と入力します。
3. コマンドにツールのパス、たとえば、C:\\Program Files\\Microsoft Visual Studio 9.0\\VC\\bin\\cl.exe と入力します。
4. 引数にツールの引数、たとえば、$(OPTIONS) $(Path) を入力します。
5. 初期ディレクトリ、たとえば、$(Dir) を入力します。
6. アイコン パスと現在のアイコンを指定します。
7. \[ファイルを保存する\] チェック ボックスをチェックして、ツール実行時にファイルを保存するように指定します。
8. \[アウトプット バーを使用する\] チェック ボックスをチェックして、ツールの結果をアウトプット バーに表示するように指定します。
9. すべて指定したら、OK をクリックします。

### あらかじめ定義された引数

|     |     |
| --- | --- |
| **$(Path)** | アクティブな文書の完全パスと名前 |
| **$(Dir)** | アクティブな文書のディレクトリ |
| **$(Filename)** | アクティブな文書のファイル拡張子を除くファイル名 |
| **$(Ext)** | アクティブな文書のファイル拡張子 |
| **$(RelPath)** | アクティブな文書の相対パスと名前 |
| **$(CurLine)** | 現在行の行番号 |
| **$(CurText)** | 現在のカーソル位置の単語 |
| **$(Solution)** | ソリューション ファイルの完全パスと名前 |
| **$(Project)** | プロジェクト ファイルの完全パスと名前 |
| **$(SolutionDir)** | ソリューションのディレクトリ |
| **$(ConfigurationName)** | アクティブな設定名 |
| **$(PlatformName)** | アクティブなプラットフォーム名 |
| **$(FrameworkSDKDir)** | Framework SDK ディレクトリ (最後のバックスラッシュを含む) |
| **$(VCInstallDir)** | Visual C++ インストール ディレクトリ (最後のバックスラッシュを含む) |
| **$(VSInstallDir)** | Visual Studio インストール ディレクトリ (最後のバックスラッシュを含む) |
| **$(WindowsSdkDir)** | Windows SDK インストール ディレクトリ (最後のバックスラッシュを含まない) |
| **$(LatestFrameworkDir)** | Framework ディレクトリ |
| **$(SourceSafe)** | Visual SourceSafe 実行ファイル (ss.exe) の完全パスと名前 |
| **$(SccProjectName)** | SourceSafe のプロジェクト名 |

### 副引数

|     |     |
| --- | --- |
| **f** | ファイル拡張子を除くファイル名 |
| **d** | ディレクトリ |
| **x** | ファイル拡張子名 |

### 例

|     |     |
| --- | --- |
| **$(Project,d)** | プロジェクト ファイルのディレクトリを返します |
| **$(Solution,f)** | ソリューション ファイルのファイル名 (ファイル拡張子無し) を返します |
| **$(Solution,f).$(Solution,x)** | ソリューション ファイルのファイル名 (ファイル拡張子付き) を返します |

## ヒント

- F6 キーまたは ESC キーを押すと、エディタにキーボード フォーカスが戻ります。
- 無題プロジェクトで右クリックを行い、\[プロジェクトを名前を付けて保存\] を選択することにより、無題プロジェクトを保存することができます。
