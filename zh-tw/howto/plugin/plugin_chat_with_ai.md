# 使用與 AI 聊天外掛程式

## 安裝
**與 AI 聊天** 作為 **ChatAI** 外掛程式提供。您可以從 [ChatAI 外掛程式下載頁面](https://www.emeditor.com/download-chatai/)下載。**ChatAI** 外掛程式不適用於 Microsoft 市集應用程式版。

### 桌面版
1. 如果您使用 EmEditor 的**桌面安裝程式**版本，請點擊 **Installer** 下載安裝程式版本。
2. 運行已下載的安裝程式。
3. 打開 EmEditor，依次轉到**自訂** > **AI 選項**。勾選**啟用 AI**。

### 可攜式版
1. 如果您使用 EmEditor 的**可攜式版**，請點擊 **Zip archive** 下載 zip 檔案。
2. 將 `ChatAI.dll` 解壓到 EmEditor 資料夾中的 `PlugIns` 資料夾。
3. 在 EmEditor 中導航到[**自訂外掛程式**](../../cmd/tools/customize_plug_ins)，並**添加**`ChatAI.dll` 檔案。
4. 打開 EmEditor，前往到**自訂** > **AI 選項**。勾選**啟用 AI**。

## API 金鑰
要開始使用與 AI 聊天，請從以下 AI 提供商中建立並複製一個 API 金鑰。

### Deepseek
1. 登錄您的 Deepseek 賬號並訪問 [API 金鑰頁面](https://platform.deepseek.com/api_keys)。
2. 點擊**建立新 API 金鑰**，為金鑰添加名稱。
3. 複製 API 金鑰。

### Google
1. 登入您的 Google AI Studio 帳戶，然後造訪 [API 金鑰頁面](https://aistudio.google.com/u/1/apikey)。
2. 按一下 **+ 建立 API 金鑰**。
3. 如果出現提示，請選擇現有的 Google Cloud 專案來建立 API 金鑰。
4. 複製 API 金鑰。

### OpenAI
1. 登錄您的 OpenAI 賬號並訪問 [API 金鑰頁面](https://platform.openai.com/api-keys)。
2. 點擊 **Create a new secret key**。或者，您也可以添加名稱並選擇一個項目。
3. 選擇 **All** 權限，或選擇 **Restricted** 並添加下方所需權限。隨著新功能的增加，所需資源可能會有所變化：
   - **Model capabilities**：**Write**
   - **Responses API**：**Write**
   - 其他所有資源：**None**
4. 複製生成的 API 金鑰。

## 安裝
1. 安裝 **ChatAI** 後，主功能表中應出現 **AI** 功能表。打開 **AI** 功能表並選擇 **與 AI 聊天**。
2. 在 **與 AI 聊天** 應用中，點擊側邊欄的 ⚙️ 按鈕並選擇**設定**。
3. 選擇您想要的**供應商**。
4. 將您的 API 金鑰貼上到**API 金鑰**欄位中。

## 聊天面板
- 在底部輸入方塊中輸入您的問題或提示，按歸位或點擊 **&#8593;** 發送。
- 您的消息會顯示在右側，AI 的回復會很快顯示在下方。提示和回復會保留在對話中，以便內容相關的回答。
- 將滑鼠停留在任意消息上，可以看到以下按鈕：
  - **複製到剪貼簿**：將消息複製到剪貼簿
  - **複製到新文檔**：打開一個新文檔並插入文字
  - **編輯消息**：對消息進行修改
  - **重新生成回復**：基於相同提示請求新的回復。如果您想要不同的表達方式時很有用。
- 點擊 **⋯** 按鈕或右鍵點擊任意消息可獲得更多選項：
  - **複製到編輯器**：將文字插入到編輯器的游標位置
  - **消息信息**：顯示該消息的詳細信息
- 程式碼塊包含編程程式碼。在程式碼塊中，您可以點擊 **⋯** 以選擇複製程式碼等選項。

## 聊天輸入
* 在聊天面板底部的輸入框中輸入您的提示。
* 按一下 **+ 檔案** 上傳檔案。
  * 此功能僅在使用 OpenAI 時可用。只能上傳具有[支援副檔名](https://platform.openai.com/docs/guides/tools-file-search#supported-files)的檔案。
  * 當支援的檔案在編輯器中開啟時，其文件名稱會顯示在檔案選取下拉選單中。
  * 您也可以按一下**瀏覽**，使用檔案瀏覽器對話方塊選取支援的檔案。
  * 上傳檔案後，「與 AI 聊天」會在 OpenAI 中建立檔案與向量資料庫（vector store）資源。之後即可在聊天對話中參照該檔案。
  * 已上傳的檔案會列在輸入區域中。按一下檔案可移除，或按右鍵以取得更多選項。
  * 參照已上傳的檔案通常比直接複製貼上檔案內容到聊天中消耗更少的 token。
  * 如需檔案搜尋費用的詳細資訊，請參閱 [OpenAI 定價](https://platform.openai.com/docs/pricing#built-in-tools)。
* 啟用**工具**以使用工具呼叫功能。AI 可使用這些 EmEditor 工具來讀取或修改您的文件。
  * 工具僅適用於 OpenAI 與 DeepSeek。
  * 將游標停留在**工具**上，然後選取**設定**以檢視並設定可用的工具。

## 側邊欄
- 對話會在側邊欄中列出。點擊 **+ 新增聊天** 建立一個新的聊天，對話內容將彼此獨立。該聊天中的回復只會使用該聊天中的內容消息。
- 點擊任意條目的 **&#8230;** 可選擇以下操作：
  - **刪除聊天**：清除該聊天中的所有消息
  - **複製到新文檔**：將該會話中的所有消息複製到新文檔
- 您可以通過點擊**關閉側邊欄**按鈕隱藏側邊欄。

## 搜尋
* 點擊側邊欄中的 🔍 按鈕以搜尋聊天訊息。
* 在搜尋框中輸入關鍵字以顯示符合的訊息。
* 在結果清單中選取一則訊息，即可直接跳到聊天面板中的該位置。

## 設定
- 您可以通過點擊側邊欄的 ⚙️ 按鈕並選擇**設定**來變更 AI 串連和使用者界面設定。
- **AI 串連**
  - 組態應用如何串連到 AI 服務。
  - 您可以選擇以下提供商：Deepseek、LM Studio/OpenAI 兼容、OpenAI
  - 點擊**測試串連**，應用會通過發送一個小的 AI 請求來檢查設定是否正確。
- **AI 參數**
  - 調整 AI 生成的相關參數。
  - 支持聊天補全和推理模型。
  - 詳細設定請參考各提供商的文檔：
    - [Deepseek](https://api-docs.deepseek.com/api/create-chat-completion)
    - [Google](https://ai.google.dev/api/generate-content)
    - [OpenAI](https://platform.openai.com/docs/api-reference/chat/create)
- **工具呼叫**
  - 這些 EmEditor 工具可以讓 AI 存取，以閱讀或修改您的文件。
  - 使用這些工具將產生額外的權杖成本。
  - 可以通過點擊聊天輸入框上的 **工具** 按鈕來啟用工具調用功能。
- **檔案**
  - 這些用於 OpenAI 檔案搜尋功能的選項，可用來控制檔案與向量儲存（Vector Store）的到期時間。
- **使用者界面**
  - 這些設定可自訂與 AI 聊天的界面。
- **調試日志選項**
  - 調試日志有助於診斷應用的技術問題。
- **更新**
  - 允許您手動更新應用程式。
- **重設設定**
  - 刪除所有聊天記錄或將所有設定重設為預設值。

## 已上傳的檔案
* 若要檢視已上傳的檔案與向量儲存庫，請點擊側邊欄中的 ⚙️ 按鈕，並選擇 **已上傳的檔案**。
* 此對話框會顯示與您的 OpenAI 帳號或組織相關聯的所有檔案與向量儲存庫。對於每個向量儲存庫，也會顯示其關聯的聊天以及目前狀態。
  * 已過期的向量儲存庫不會產生儲存費用。
* 您可以從您的帳號或組織中選取並刪除檔案或向量儲存庫。

## LM Studio 安裝說明
集成 LM Studio 需要進行初始設定。請按照以下步驟設定 LM Studio。

1. 從 [lmstudio.ai](https://lmstudio.ai/) 下載並安裝 LM Studio。
2. 在 LM Studio 中，前往 **Discover** 標籤頁下載模型。
    - 推薦嘗試 `mistralai/mistral-7b-instruct-v0.3` 模型，因為它可以在大多數電腦上運行。
    - 加載系統不支援的模型可能會導致錯誤。
3. 在 LM Studio 視窗頂部，加載您下載的模型。
4. 前往 **Developer** 標籤頁。點擊左上角的切換以啟動服務器，狀態應顯示為「Status: Running」。
5. 打開切換旁邊的**設定**。**啟用 CORS**。
6. 打開 **與 AI 聊天** 並進入**設定**。
7. 在 **AI 串連**頁面，將**提供商**設定為「LM Studio/OpenAI 兼容」。**API 金鑰**欄位留空。
8. 前往 **AI 參數**頁面。在**模型**下選擇您下載的模型。
   - 如果未列出，請確認 LM Studio 已啟用 CORS。您也可以選擇「其他」手動輸入模型名稱。
9. 返回 **AI 串連**，點擊**測試串連**以確保可以串連到 LM Studio。

- 每次重啟電腦後，LM Studio 服務會自動啟動。但在與 AI 聊天中使用前，您需要手動加載模型。