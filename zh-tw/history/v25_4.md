# Version 25.4

2025 年 11 月 5 日

## 一般新增功能

- 現在，您可以在 EmEditor 中直接建立**程式碼片段（Snippets）**，並使用現有的[**程式碼片段**外掛程式](../howto/plugin/plugin_snippets)將其插入。它們可通過功能表訪問，您也可以將它們分配給工具列按鈕或鍵盤快速鍵。您甚至可以將程式碼片段按鈕放在 Markdown/HTML 工具列的任意位置。 {{pro}}
- 新增**程式碼片段**工具列。{{pro}}
- 提升了多項操作的速度，包括「尋找」、「取代」、「多檔尋找」和「多檔取代」。 {{profree}}

### 測試結果：

|  | v25.3 | v25.4 | 與 v25.3 比較 |
| --- | --- | --- | --- |
| 多檔尋找 \[\*A\] | 2.566 秒 | 0.393 秒 | 快 6.53 倍 |
| 多檔取代 \[\*B\] | 2.062 秒 | 1.034 秒 | 快 1.99 倍 |
| 尋找 (Select All) \[\*C\] | 0.189 秒 | 0.051 秒 | 快 3.71 倍 |
| 全部取代 \[\*D\] | 0.188 秒 | 0.063 秒 | 快 2.98 倍 |

\*A: 在 14 個 ASCII 或 UTF-8 隨機檔案中尋找 "abc"，總計 3.81 GB。
\*B: 在 14 個 ASCII 或 UTF-8 隨機檔案中將 "abc" 取代為 "###"，總計 3.81 GB。
\*C: 在 2.00 GB 的維基百科轉儲檔案（UTF-8）中全選 "αβ"。
\*D: 在 2.00 GB 的維基百科轉儲檔案（UTF-8）中將 "αβ" 全部取代為 "##"。
\*所有: 全部預設選項，Windows 11，Ryzen 9 7950X，96 GB 記憶體。

## 新增命令

- [插入程式碼片段](../cmd/insert/insert_snippet1) {{pro}}
- [程式碼片段工具列](../cmd/view/show_snippets_bar) {{pro}}
- [自訂程式碼片段](../cmd/tools/customize_snippets) {{pro}}
- 移除了**自訂標記 - 標記清單**、**自訂標記 - 自動標記**和**自訂標記 - 選項**命令。{{profree}}

## 外掛程式新功能 {{pro}}

- 添加了 **FLAG_FIND_TRUNCATE** 旗標到 [**GREP_INFO_EX** 結構](../plugin/structure/grep_info_ex)中。

### 與 AI 聊天

- 更換了聊天消息的存儲後端，以改進組織方式並優化性能。
- 在「設定」>「AI 串連」中新增**使用 … 環境變數**選項，允許「與 AI 聊天」使用該環境變數作為 API 金鑰。
- 在「設定」>「AI 參數」中新增**網頁搜索**選項，使包括 GPT-5 在內的部分 OpenAI 模型可以搜索互聯網以獲取最新信息。
- 在「設定」>「AI 參數」中新增**文字詳盡度**選項，用於控制文字匯出的詳盡程度。

## 新增巨集功能 {{pro}}

- 已在 **Editor** 對象的 [**FindInFiles** 方法](../macro/editor/editor_findinfiles)中新增 **eeFindFileLineTruncated** 旗標。

### 備註

- \[P\] 僅限 EmEditor 專業版
- \[PF\] EmEditor 專業版與免費版