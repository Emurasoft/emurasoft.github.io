# 使用项目插件

**项目** 插件默认安装在 EmEditor Professional 中。该插件会显示文件夹目录树并让你能从文件夹目录树中打开文件。

要用新的 **项目** 创建一个插件：

1. 在 **插件** 栏上点击 **![](../../images/projects.gif)** 。或在 **工具** 菜单下，指向 **插件**，然后点击 **项目**， 便会出现 **项目** 自定义分栏。
2. 右击 **项目** 栏，选择 **新建项目**。
3. 右击 **无标题项目**，把鼠标指针移到“项目”上，然后点击 **“添加现有的文件”**。
4. 选择所有你想要包含在项目中的文件。

## 

### 项目插件命令

右击项目栏显示下列选项：

|     |     |
| --- | --- |
| **展开/折叠** | 展开或折叠节点。 |
| **打开所有文件** | 打开所有文件夹中的文件。 |
| **打开** | 打开文件。 |
| **以只读方式打开** | 以只读方式打开文件。 |
| **使用指定的编码打开** | 用指定的编码打开文件。 |
| **新建文件夹** | 创建一个新文件夹。 |
| **剪切** | 把选取的条目移动到剪贴板上。 |
| **复制** | 复制选取的条目并把它粘贴到剪贴板上。 |
| **粘贴** | 插入剪贴板内容。 |
| **移除** | 移除选取条目。 |
| **重命名** | 重命名选取条目。 |
| **执行解决方案** | 执行解决方案。 |
| **新建解决方案** | 创建一个新的解决方案。 |
| **打开解决方案** | 打开一个已存在的解决方案。 |
| **解决方案另存为** | 用一个新名称保存解决方案文件。 |
| **最近解决方案列表** | 打开一个指定的最近访问的解决方案（多条目）。 |
| **新建项目** | 创建一个新项目。 |
| **打开项目** | 打开一个已存在的项目。 |
| **项目另存为** | 用一个新名称保存项目文件。 |
| **添加现有的文件** | 添加现有的文件到项目中。 |
| **加入当前文件** | 把当前文件加入到项目中。 |
| **添加所有打开的文件** | 添加所有打开的文件到项目中。 |
| **最近项目列表** | 打开一个指定的最近访问的项目（多个条目）。 |
| **设为启动项目** | 把指定的项目设为启动项目。 |
| **仅文件名** | 仅为每个条目显示文件名。 |
| **相对路径** | 显示每个条目的相对路径。 |
| **完整路径** | 显示每个条目的完整路径。 |
| **刷新符号列表** | 刷新当前项目的符号列表。 |
| **刷新所有符号列表** | 刷新所有项目的符号列表。 |
| **符号列表** | 显示或隐藏符号列表。 |
| **配置** | 列出可用的配置。 |
| **平台** | 列出可用的平台。 |
| **当前解决方案模板属性** | 显示当前解决方案模板属性。 |
| **解决方案模板** | 定义解决方案模板。 |
| **插件属性** | 显示插件属性。 |
| **工具列表** | 运行一个指定的工具。 |

### 项目插件工具栏

|     |     |
| --- | --- |
| **![](../../images/newsolution.gif) 新建解决方案** | 创建一个新的解决方案。 |
| **![](../../images/opensolution.gif) 打开解决方案** | 打开一个已存在的解决方案。 |
| **![](../../images/runsolution.gif) 执行解决方案** | 执行打开的解决方案。 |
| **![](../../images/parameterinformation.gif) 参数信息** | 显示参数信息。 |
| **![](../../images/gotodefinition.gif) 转到定义** | 让光标跳至定义。 |
| **![](../../images/popbrowsecontent.gif) 弹出浏览上下文** | 让光标返回到前一个。 |
| **![](../../images/symbollist.gif) 符号列表** | 显示符号的列表。 |
| **![](../../images/propertiesforcurrentsolutiontemplate.gif) 当前解决方案模板属性** | 为当前解决方案模板显示自定义属性。“常规”页面包括“解决方案格式”，“文件扩展名”，“只读”等选项。“配置”页面包括配置，平台，以及宏的设定。“符号”页面包括“自动刷新符号列表”以及“Ctags 附加参数”等设置。“工具”页面包括自定义工具。“键盘”页面包括为该插件上的命令分配键盘快捷键。 |
| **![](../../images/solutiontemplates.gif) 解决方案模板** | 显示 **解决方案模板** 对话框。 |
| **![](../../images/pluginproperties.gif) 插件属性** | 显示插件属性。 |

### 解决方案模板

每个你所创建，打开或保存在项目插件中的模板都是一个解决方案模板。每个解决方案模板指定相关联的文件扩展名的功能，包括解决方案格式，宏，工具以及键盘快捷键。当你打开一个解决方案文件，一个与文件扩展名相关联的解决方案模板会被选取并按该模板所设定的功能执行。

### “解决方案模板”对话框

该对话框会出现当您点击 ![](../../images/solutiontemplates.gif) 按钮。可用的解决方案模板会显示在列表中。点击「属性」按钮来显示选取的解决方案模板属性。

### 解决方案模板属性

**“常规”页面**

|     |     |
| --- | --- |
| **解决方案格式** | 选择一个解决方案格式。目前，只有 **EmEditor** 以及 **Visual Studio** 可以选取。 |
| **文件扩展名** | 为解决方案文件指定扩展名。这样，当你打开一个解决方案文件时，一个与这个文件扩展名相关联的解决方案模板就会被选取。 |
| **只读** | 指定解决方案是否只读。如果你设为只读，你无法添加文件到该解决方案中，并且项目文件不会被重写当你保存该解决方案时。 |

**“配置”页面**

|     |     |
| --- | --- |
| **配置** | 选择一个被定义的配置。选择 <新建> 让你定义一个新配置。选择 <编辑\> 让你删除一个配置。 |
| **平台** | 选择一个定义过的平台。选择 <新建> 让你定义一个新平台。选择 <编辑\> 让你删除一个平台。 |
| **宏** | 显示定义过的宏列表。它让你能为每个宏以及每个配置和平台的组合指定一个值。 |
| **新建** | 创建一个新的宏。 |
| **删除** | 删除一个被选取的宏。 |
| **重命名** | 重命名一个被选取的宏。 |

**“符号”页面**

|     |     |
| --- | --- |
| **自动刷新所有符号列表** | 指定是否要更新符号列表当添加一个新文件时。 |
| **Ctags 附加参数（高级选项）** | 指定 Ctags 附加参数。这是一个高级选项，设置错误的参数会让符号列表工作不正常。 |

**“工具”页面**

|     |     |
| --- | --- |
| **工具** | 显示定义过的工具列表。 |
| **新建** | 创建一个新工具。 |
| **删除** | 删除选取的工具。 |
| **复制** | 复制选取的工具。 |
| **上移** | 在列表上把选取的工具上移。 |
| **下移** | 在列表上把选取的工具下移。 |
| **属性** | 显示或编辑选取工具属性。 |

**“键盘”页面**

|     |     |
| --- | --- |
| **命令** | 列出可用命令。 |
| **按下新的快捷键** | 为选取的命令输入新的快捷键。 |
| **当前键** | 被分配给选取命令的当前键。 |
| **分配** | 分配快捷键给当前选取的命令。 |
| **删除** | 删除选取的键。 |

### 创建解决方案的配置以及宏

在当前解决方案模板属性对话框中的“配置”页面上，你能创建并编辑配置和宏。要创建一个新的配置:

1. 点击一下配置下的 <默认>，在弹出的下拉列表框中选择 <新建>。
2. 你能指定配置名称。例如，创建一个叫做 Debug 的配置。
3. 你能为每个配置创建宏。
4. 在宏列表下，点击「新建」。把宏命名为 OPTIONS 并把它的值指定为 D \_Debug。
5. 现在创建另一个叫做 Release 的配置。
6. 在 Release 配置下，把叫作 OPTIONS 的宏的值指定为 /O1。
7. 现在你有指定的配置，以及每个指定配置中的宏。

### 创建解决方案工具

在当前解决方案模板属性对话框中的“工具”页面上，你你能创建新工具。工具属性让你能指定标题，命令，参数，初始目录，图标路径，以及当前图标等。工具属性提供了一些预设的参数，例如文件路径和当前行。要创建一个新工具:

1. 在“工具”页面上点击「新建」。
2. 把工具命名为“编译”。
3. 指定命令，例如，C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\VC\\bin\\cl.exe.
4. 指定参数，例如，$(OPTIONS) $(Path)。
5. 指定初始路径，例如 $(Dir)。
6. 指定图标路径以及当前图标。
7. 勾选“保存文件”复选框，指示工具保存文件。
8. 勾选“在输出栏中显示”来指定所需的输出编码
9. 完成后，点击“确定”。

### 预设参数

|     |     |
| --- | --- |
| **$(Path)** | 当前文档的完整路径及名称。 |
| **$(Dir)** | 当前文档的目录。 |
| **$(Filename)** | 当前文档不带扩展名的文件名。 |
| **$(Ext)** | 当前文档的扩展名。 |
| **$(RelPath)** | 当前文档的相对路径及名称。 |
| **$(CurLine)** | 当前行的行号。 |
| **$(CurText)** | 当前光标位置处的单词。 |
| **$(Solution)** | 解决方案文件的完整路径及名称。 |
| **$(Project)** | 项目文件的完整路径及名称。 |
| **$(SolutionDir)** | 解决方案的目录。 |
| **$(ConfigurationName)** | 当前配置名称。 |
| **$(PlatformName)** | 当前平台名称。 |
| **$(FrameworkSDKDir)** | 末端带反斜杠的 framework SDK 目录。 |
| **$(VCInstallDir)** | 末端带反斜杠的 Visual C++ 安装目录。 |
| **$(VSInstallDir)** | 末端带反斜杠的 Visual <br> Studio 安装目录。 |
| **$(WindowsSdkDir)** | 末端没有反斜杠的 Windows <br> SDK 安装目录。 |
| **$(LatestFrameworkDir)** | Framework 目录。 |
| **$(SourceSafe)** | Visual SourceSafe executable (ss.exe) 的完整路径以及名称。 |
| **$(SccProjectName)** | SourceSafe 的项目名称。 |

### Sub Arguments

|     |     |
| --- | --- |
| **f** | 不带扩展名的文件名。 |
| **d** | 目录。 |
| **x** | 文件扩展名。 |

### Examples

|     |     |
| --- | --- |
| **$(Project,d)** | 返回项目文件的目录。 |
| **$(Solution,f)** | 返回解决方案文件的不带扩展名的文件名称。 |
| **$(Solution,f).$(Solution,x)** | 返回解决方案文件的包含扩展名的文件名称。 |

## 提示

- 按 **ESC** 键能让键盘焦点回到编辑器中。
- 你可以在 **无标题项目** 上右击，选择 **项目另存为** 来保存 **无标题项目**。
