# 使用与 AI 聊天插件

## 安装
**与 AI 聊天** 作为 **ChatAI** 插件提供。您可以从 [ChatAI 插件下载页面](https://www.emeditor.com/download-chatai/)下载。**ChatAI** 插件不适用于商店版或 32 位版本的 EmEditor。

- 如果您使用的是 **桌面安装版** EmEditor，请点击 **Installer** 下载安装程序版本。然后，运行下载的安装程序。
- 如果您使用的是 **便携版** EmEditor，请点击 **Zip archive** 下载 zip 文件，然后将 `ChatAI.dll` 文件解压到 EmEditor 文件夹下的 `PlugIns` 文件夹中。在 EmEditor 中进入 [**自定义插件**](../../cmd/tools/customize_plug_ins)，并**添加** `ChatAI.dll` 文件。

## OpenAI API 密钥
您需要一个 OpenAI API 密钥才能使用 ChatAI 插件。如果您还没有 OpenAI API 密钥，请按照以下步骤操作：
1. 登录您的 OpenAI 账户并访问 [API 密钥页面](https://platform.openai.com/settings/organization/api-keys)。
2. 点击 **Create a new secret key**。或者，您也添加名称并选择一个项目。
3. 选择 **All** 权限，或选择 **Restricted** 并添加以下所需权限。随着新功能的添加，所需资源可能会发生变化：
   - **Model capabilities**: **Write**
   - 其他所有资源: **None**
4. 复制生成的 API 密钥。您将在下一步中用到它。

## 设置
1. 安装 **ChatAI** 后，主菜单中应会出现 **AI** 菜单。点击 **AI** 菜单，选择 **自定义**，然后选择 **AI 选项**。如果没有出现 **AI** 菜单，也可以进入 **工具 > 自定义... > AI 选项**。
2. 勾选 **启用 AI** 选项框。会弹出提示，询问您是否同意条款。如果同意，请点击 **继续**。
3. 将您的 API 密钥粘贴到 **OpenAI API 密钥** 文本框中。点击 **确定**。

## 启动与 AI 聊天
在 EmEditor 中，点击 **AI** 菜单下的 **与 AI 聊天**。如果没有 **AI** 菜单，也可以在 **插件** 菜单中访问 **与 AI 聊天**。

## 聊天面板
- 在底部的输入框中输入您的问题或提示，然后按回车或点击 **&#8593;** 发送。
- 您的消息会显示在右侧，AI 的回复会很快显示在其下方。提示和回复会保留在对话中，以便进行情境感知回复。
- 将鼠标悬停在任意消息上可看到以下按钮：
  - **复制到剪贴板**：将消息复制到剪贴板
  - **编辑消息**：对消息进行修改
  - **重新生成回复**：基于相同提示请求新的回复。如果您想要不同的表述时很有用。
- 右键点击任意消息可获得更多选项：
  - **复制**：复制到剪贴板
  - **复制到编辑器**：将文本插入到编辑器中的光标位置
  - **复制到新文档**：打开新文档并插入文本
- 代码块中包含编程代码。在代码块中，您可以点击 **…** 以获得复制代码的选项。

## 侧边栏
- 对话会在侧边栏中显示。点击 **+ 新建聊天** 可创建一个包含不同对话的新聊天。某个聊天中的回复只会使用该聊天对话中的消息上下文。
- 点击任意条目的 **&#8230;** 可获得以下选项：
  - **删除聊天**：清除该聊天中的所有消息
  - **复制到新文档**：将对话中的所有消息复制到新文档
- 点击 &#9881;&#65039;（打开菜单）可进行应用设置。
  - **调试日志选项**：调试日志有助于诊断应用的技术问题
  - **键盘快捷键**：查看与 AI 聊天的键盘快捷键
- 您可以通过 **关闭侧边栏** 按钮隐藏侧边栏。
