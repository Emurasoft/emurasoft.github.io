# 使用与 AI 聊天插件

## 安装
**与 AI 聊天** 作为 **ChatAI** 插件提供。您可以从 [ChatAI 插件下载页面](https://www.emeditor.com/download-chatai/)下载。**ChatAI** 插件不适用于商店版或 32 位版本的 EmEditor。

- 如果您使用的是 **桌面安装版** EmEditor，请点击 **Installer** 下载安装程序版本。然后，运行下载的安装程序。
- 如果您使用的是 **便携版** EmEditor，请点击 **Zip archive** 下载 zip 文件，然后将 `ChatAI.dll` 文件解压到 EmEditor 文件夹下的 `PlugIns` 文件夹中。在 EmEditor 中进入 [**自定义插件**](../../cmd/tools/customize_plug_ins)，并**添加** `ChatAI.dll` 文件。

## API 密钥
要开始使用与 AI 聊天，请从以下 AI 提供商中创建并复制一个 API 密钥。

### Deepseek API 密钥
1. 登录您的 Deepseek 账号并访问 [API 密钥页面](https://platform.deepseek.com/api_keys)。
2. 点击**创建新 API 密钥**，为密钥添加名称。
3. 复制 API 密钥。

### OpenAI API 密钥
1. 登录您的 OpenAI 账号并访问 [API 密钥页面](https://platform.openai.com/api-keys)。
2. 点击 **Create a new secret key**。或者，您也可以添加名称并选择一个项目。
3. 选择 **All** 权限，或选择 **Restricted** 并添加下方所需权限。随着新功能的增加，所需资源可能会有所变化：
   - **Model capabilities**：**Write**
   - **Responses API**：**Write**
   - 其他所有资源：**None**
4. 复制生成的 API 密钥。

## 设置
1. 安装 **ChatAI** 后，主菜单中应出现 **AI** 菜单。打开 **AI** 菜单并选择 **与 AI 聊天**。
2. 在 **与 AI 聊天** 应用中，点击侧边栏的 ⚙️ 按钮并选择**设置**。
3. 将您的 API 密钥粘贴到**API 密钥**字段中。

## 聊天面板
- 在底部输入框中输入您的问题或提示，按回车或点击 **&#8593;** 发送。
- 您的消息会显示在右侧，AI 的回复会很快显示在下方。提示和回复会保留在对话中，以便上下文相关的回答。
- 将鼠标悬停在任意消息上，可以看到以下按钮：
  - **复制到剪贴板**：将消息复制到剪贴板
  - **复制到新文档**：打开一个新文档并插入文本
  - **编辑消息**：对消息进行修改
  - **重新生成回复**：基于相同提示请求新的回复。如果您想要不同的表达方式时很有用。
- 点击 **⋯** 按钮或右键点击任意消息可获得更多选项：
  - **复制到编辑器**：将文本插入到编辑器的光标位置
  - **消息信息**：显示该消息的详细信息
- 代码块包含编程代码。在代码块中，您可以点击 **⋯** 以选择复制代码等选项。

## 侧边栏
- 对话会在侧边栏中列出。点击 **+ 新建聊天** 创建一个新的聊天，对话内容将彼此独立。该聊天中的回复只会使用该聊天中的上下文消息。
- 点击任意条目的 **&#8230;** 可选择以下操作：
  - **删除聊天**：清除该聊天中的所有消息
  - **复制到新文档**：将该会话中的所有消息复制到新文档
- 您可以通过点击**关闭侧边栏**按钮隐藏侧边栏。

## 设置
- 您可以通过点击侧边栏的 ⚙️ 按钮并选择**设置**来更改 AI 连接和用户界面设置。
- **AI 连接**
  - 配置应用如何连接到 AI 服务。
  - 您可以选择以下提供商：Deepseek、LM Studio/OpenAI 兼容、OpenAI
  - 点击**测试连接**，应用会通过发送一个小的 AI 请求来检查设置是否正确。
- **AI 参数**
  - 调整 AI 生成的相关参数。
  - 支持聊天补全和推理模型。
  - 详细设置请参考各提供商的文档：
    - [Deepseek](https://api-docs.deepseek.com/api/create-chat-completion)
    - [OpenAI](https://platform.openai.com/docs/api-reference/chat/create)
- **用户界面**
  - 这些设置可自定义与 AI 聊天的界面。
- **调试日志选项**
  - 调试日志有助于诊断应用的技术问题。

## LM Studio 设置说明
集成 LM Studio 需要进行初始设置。请按照以下步骤设置 LM Studio。

1. 从 [lmstudio.ai](https://lmstudio.ai/) 下载并安装 LM Studio。
2. 在 LM Studio 中，前往 **Discover** 标签页下载模型。
    - 推荐尝试 `mistralai/mistral-7b-instruct-v0.3` 模型，因为它可以在大多数电脑上运行。
    - 加载系统不支持的模型可能会导致错误。
3. 在 LM Studio 窗口顶部，加载您下载的模型。
4. 前往 **Developer** 标签页。点击左上角的开关以启动服务器，状态应显示为“Status: Running”。
5. 打开开关旁边的**设置**。**启用 CORS**。
6. 打开 **与 AI 聊天** 并进入**设置**。
7. 在 **AI 连接**页面，将**提供商**设置为“LM Studio/OpenAI 兼容”。**API 密钥**字段留空。
8. 前往 **AI 参数**页面。在**模型**下选择您下载的模型。
   - 如果未列出，请确认 LM Studio 已启用 CORS。您也可以选择“其他”手动输入模型名称。
9. 返回 **AI 连接**，点击**测试连接**以确保可以连接到 LM Studio。

- 每次重启电脑后，LM Studio 服务会自动启动。但在与 AI 聊天中使用前，您需要手动加载模型。